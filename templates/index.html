<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ç§ã®æ—¥è¨˜</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <header>
        <div class="header-content">
            <h1>ğŸ“ ç§ã®æ—¥è¨˜</h1>
            <a href="/categories" class="back-link">ã‚«ãƒ†ã‚´ãƒªç®¡ç†</a>
        </div>
        <p class="diary-count">
            {% if keyword or year_month or category_filter %}
            æ¤œç´¢çµæœ: {{ diaries|length }}ä»¶
            {% else %}
            å…¨{{ diaries|length }}ä»¶ã®æ—¥è¨˜
            {% endif %}
        </p>
    </header>

    <div class="container">
        <!-- æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ  -->
        <div class="search-form">
            <form action="/" method="GET">
                <div class="search-inputs">
                    <div class="search-group">
                        <label>ğŸ” ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢</label>
                        <input type="text" name="keyword" 
                               value="{{ keyword }}"
                               placeholder="ã‚¿ã‚¤ãƒˆãƒ«ã‚„æœ¬æ–‡ã§æ¤œç´¢">
                    </div>
                    
                    <div class="search-group">
                        <label>ğŸ“… å¹´æœˆã§çµã‚Šè¾¼ã¿</label>
                        <input type="month" name="year_month" 
                               value="{{ year_month }}">
                    </div>
                
                <div class="search-buttons">
                    <button type="submit" class="search-button">æ¤œç´¢</button>
                    <a href="/" class="clear-button">ã‚¯ãƒªã‚¢</a>
                </div>
            </form>
        </div>

        <!-- æ—¥è¨˜æŠ•ç¨¿ãƒ•ã‚©ãƒ¼ãƒ  -->
        <div class="diary-form">
            <h2>æ–°ã—ã„æ—¥è¨˜ã‚’æ›¸ã</h2>
            <form action="/add" method="POST">
                <div class="form-group">
                    <label>ã‚¿ã‚¤ãƒˆãƒ«</label>
                    <input type="text" name="title" required 
                           placeholder="ä»Šæ—¥ã®ã‚¿ã‚¤ãƒˆãƒ«">
                </div>
                
                <div class="form-group">
                    <label>ã‚«ãƒ†ã‚´ãƒª</label>
                    <select name="category_id" class="category-select">
                        <option value="">ã‚«ãƒ†ã‚´ãƒªãªã—</option>
                        {% for category in categories %}
                        <option value="{{ category.id }}">{{ category.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                
                <div class="form-group">
                    <label>æœ¬æ–‡</label>
                    <textarea name="content" rows="10" required
                              placeholder="ä»Šæ—¥ã®å‡ºæ¥äº‹ã‚’æ›¸ã„ã¦ãã ã•ã„..."></textarea>
                </div>
                
                <button type="submit" class="submit-button">æŠ•ç¨¿ã™ã‚‹</button>
            </form>
        </div>

        <!-- æ—¥è¨˜ä¸€è¦§ -->
        <div class="diaries-list">
            <h2>
                {% if keyword or year_month or category_filter %}
                æ¤œç´¢çµæœ
                {% else %}
                ã“ã‚Œã¾ã§ã®æ—¥è¨˜
                {% endif %}
            </h2>
            
            {% if diaries|length == 0 %}
            <div class="no-diary">
                {% if keyword or year_month or category_filter %}
                <p>æ¤œç´¢æ¡ä»¶ã«ä¸€è‡´ã™ã‚‹æ—¥è¨˜ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ</p>
                {% else %}
                <p>ã¾ã æ—¥è¨˜ãŒæŠ•ç¨¿ã•ã‚Œã¦ã„ã¾ã›ã‚“</p>
                {% endif %}
            </div>
            {% else %}
            
            {% for diary in diaries %}
            <div class="diary-card">
                <div class="diary-header">
                    <div class="diary-title-area">
                        <h3 class="diary-title">{{ diary.title }}</h3>
                        {% if diary.category_name %}
                        <span class="category-badge">{{ diary.category_name }}</span>
                        {% endif %}
                    </div>
                    <span class="diary-date">{{ diary.created_at|format_date }}</span>
                </div>
                <div class="diary-content">
                    {{ diary.content[:100] }}{% if diary.content|length > 100 %}...{% endif %}
                </div>
                <div class="diary-actions">
                    <a href="/detail/{{ diary.id }}" class="detail-link">è©³ç´°ã‚’è¦‹ã‚‹</a>
                </div>
            </div>
            {% endfor %}
            
            {% endif %}
        </div>
    </div>
</body>
</html>